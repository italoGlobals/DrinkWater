platform :android do
  desc "Build APK para desenvolvimento"
  lane :build_apk do
    # Desabilita prompts interativos
    ENV["CI"] = "true"
    ENV["FASTLANE_SKIP_UPDATE_CHECK"] = "1"
    ENV["FASTLANE_HIDE_TIMESTAMP"] = "true"
    
    gradle(
      task: 'clean',
      print_command: true
    )
    gradle(
      task: 'build',
      print_command: true,
      flags: '--stacktrace',
      properties: {
        "android.injected.signing.store.file" => ENV["KEYSTORE_PATH"],
        "android.injected.signing.store.password" => ENV["STORE_PASSWORD"],
        "android.injected.signing.key.alias" => ENV["KEY_ALIAS"],
        "android.injected.signing.key.password" => ENV["KEY_PASSWORD"],
      }
    )
  end
end
